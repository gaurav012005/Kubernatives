
# âš–ï¸ğŸ“ˆ Kubernetes Autoscaling

Autoscaling automatically adjusts your application's resources based on real-time demand â€” saving ğŸ’° and boosting âš¡ï¸ performance.

---

## ğŸ”„ **Horizontal Pod Autoscaler (HPA)**  
ğŸ“Œ Scales the number of pods based on CPU, memory, or custom metrics.

ğŸ”¹ **Example YAML:**
```
apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  name: nginx-hpa
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: nginx
  minReplicas: 2
  maxReplicas: 5
  metrics:
  - type: Resource
    resource:
      name: cpu
      target:
        type: Utilization
        averageUtilization: 50
```

ğŸ”¹ **Commands:**
```bash
kubectl autoscale deployment nginx --cpu-percent=50 --min=2 --max=5
kubectl get hpa
```

---

## ğŸ“¦ **Vertical Pod Autoscaler (VPA)**  
ğŸ“Œ Adjusts CPU/memory *requests and limits* vertically over time.  
ğŸš¨ Requires VPA controller (not enabled by default).

ğŸ”¹ **Example YAML:**
```yaml
apiVersion: autoscaling.k8s.io/v1
kind: VerticalPodAutoscaler
metadata:
  name: vpa-demo
spec:
  targetRef:
    apiVersion: "apps/v1"
    kind: Deployment
    name: demo-app
  updatePolicy:
    updateMode: "Auto"
```

ğŸ”¹ **Install VPA:**
```bash
kubectl apply -f https://github.com/kubernetes/autoscaler/releases/latest/download/vertical-pod-autoscaler.yaml
```

---

## âš¡ğŸ•¹ï¸ **KEDA â€“ Kubernetes Event-Driven Autoscaler**  
ğŸ“Œ Scales pods based on **external events** like Kafka, Prometheus, Azure Queue, etc.

ğŸ”¹ **Example YAML:**
```yaml
apiVersion: keda.sh/v1alpha1
kind: ScaledObject
metadata:
  name: keda-scaler
spec:
  scaleTargetRef:
    name: my-worker
  triggers:
  - type: cpu
    metadata:
      type: Utilization
      value: "50"
```

ğŸ”¹ **Install KEDA:**
```bash
kubectl apply -f https://github.com/kedacore/keda/releases/latest/download/keda.yaml
```

---

## ğŸ“ **Metrics Server (Required for HPA)**  
Collects resource usage metrics (CPU/Memory) for autoscaling.

ğŸ”¹ **Install Metrics Server:**
```bash
kubectl apply -f https://github.com/kubernetes-sigs/metrics-server/releases/latest/download/components.yaml
```

ğŸ”¹ **Commands:**
```bash
kubectl top pod       # View pod usage
kubectl top node      # View node usage
```

---

# ğŸ§²ğŸ“Œ Node Affinity

ğŸ“Œ **Node Affinity** ensures pods are scheduled to nodes matching specific labels.

ğŸ”¹ **Example YAML:**
```yaml
affinity:
  nodeAffinity:
    requiredDuringSchedulingIgnoredDuringExecution:
      nodeSelectorTerms:
      - matchExpressions:
        - key: disktype
          operator: In
          values:
          - ssd
```

âœ… This schedules pods only on nodes labeled with `disktype=ssd`.

ğŸ”¹ **Label a node:**
```bash
kubectl label nodes <node-name> disktype=ssd
```

---

# ğŸ”ğŸ›¡ï¸ Role-Based Access Control (RBAC)

RBAC helps you **control access** in Kubernetes â€” who can do what, where.

---

## ğŸ‘©â€ğŸ’¼ What is a User?
â¡ï¸ A user is an external identity (e.g., developer, admin) managed outside the cluster.

## ğŸ§‘â€ğŸ’¼ What is a Service Account?
â¡ï¸ A service account is used **by Pods** to access the Kubernetes API.

---

## ğŸ“„ Role + RoleBinding YAML for a Service Account
```yaml
apiVersion: v1
kind: ServiceAccount
metadata:
  name: my-service-account
  namespace: dev
---
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: pod-reader
  namespace: dev
rules:
- apiGroups: [""]
  resources: ["pods"]
  verbs: ["get", "list"]
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: read-pods
  namespace: dev
subjects:
- kind: ServiceAccount
  name: my-service-account
  namespace: dev
roleRef:
  kind: Role
  name: pod-reader
  apiGroup: rbac.authorization.k8s.io
```

---

## ğŸ§° Useful RBAC Commands
```bash
# Create a service account
kubectl create serviceaccount my-sa -n dev

# View all service accounts in a namespace
kubectl get serviceaccounts -n dev

# Describe a RoleBinding
kubectl describe rolebinding read-pods -n dev
```

---

Let me know if you want this grouped into a downloadable `.md` file or added to your existing repo structure! ğŸ˜Š
